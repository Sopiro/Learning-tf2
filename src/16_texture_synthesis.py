import tensorflow as tf
import matplotlib.pyplot as plt
import cv2
import IPython.display as display
import time
import imageio

# Download image from URL and store it to keras's cache folder (C:\Users\(UserName)\.keras\datasets)
# style_image_path = tf.keras.utils.get_file('style.jpg', 'http://bit.ly/2mGfZIq')
style_image_path = tf.keras.utils.get_file('style3.jpg',
                                           'data:image/jpeg;base64,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')

style_image = plt.imread(style_image_path)
style_image = cv2.resize(style_image, dsize=(256, 256))
style_image = style_image / 255.0

# Initialize target image with random noise
target_image = tf.random.uniform(shape=(256, 256, 3))

# Import VGG-19 network where the weights fit to imagenet
vgg = tf.keras.applications.VGG19(include_top=False, weights='imagenet')

# Check out the layers
# for layer in vgg.layers:
#     print(layer.name)

conv_layers = ['block1_conv1',
               'block2_conv1',
               'block3_conv1',
               'block4_conv1',
               'block5_conv1']

# Extract convolution layer outputs and set to model's output
vgg.trainable = False
conv_outs = [vgg.get_layer(name).output for name in conv_layers]
model = tf.keras.Model(inputs=[vgg.input], outputs=conv_outs)


# Calculate gram matrix of Convolution outputs
def gram_matrix(tensor):
    channels = int(tensor.shape[-1])
    a = tf.reshape(tensor, [-1, channels])
    size = tf.shape(a)[0]
    gram = tf.matmul(a, a, transpose_a=True)
    return gram / tf.cast(size, tf.float32)


# Process forward to network
style_batch = style_image.astype('float32')
style_batch = tf.expand_dims(style_batch, axis=0)  # Insert dimension for batching
style_output = model.call(tf.keras.applications.vgg19.preprocess_input(style_batch * 255.0))

# Visualize convolution layer output
# print(style_output[0].shape)
# plt.imshow(tf.squeeze(style_output[0][:, :, :, 0], 0), cmap='gray')
# plt.show()

style_outputs = [gram_matrix(out) for out in style_output]


# plt.figure(figsize=(12, 10))
# for c in range(5):
#     plt.subplot(3, 2, c + 1)
#     array = sorted(style_outputs[c].numpy()[0].tolist())
#     array = array[::-1]
#     plt.bar(range(style_outputs[c].shape[0]), array)
#     plt.title(style_layers[c])
# plt.show()


# Calculate and get gram matrices of target image
def get_outputs(image):
    image_batch = tf.expand_dims(image, axis=0)
    output = model.call(image_batch * 255.0)
    outputs = [gram_matrix(out) for out in output]
    return outputs


# Calculate MSE loss between target texture and style texture
def get_loss(outputs, style_outputs):
    return tf.reduce_sum([tf.reduce_mean((o - s) ** 2) for o, s in zip(outputs, style_outputs)])


def clip_0_1(image):
    return tf.clip_by_value(image, clip_value_min=0.0, clip_value_max=1.0)


def high_pass_x_y(image):
    x_var = image[:, 1:, :] - image[:, :-1, :]
    y_var = image[1:, :, :] - image[:-1, :, :]
    return x_var, y_var


def total_variation_loss(image):
    x_deltas, y_deltas = high_pass_x_y(image)
    return tf.reduce_mean(x_deltas ** 2) + tf.reduce_mean(y_deltas ** 2)


opt = tf.keras.optimizers.Adam(learning_rate=0.2, beta_1=0.99, epsilon=1e-1)

total_variation_weight = 1e11
style_weight = 1e-3


# Use tensorflow's autograph function.
# Let tensorflow generate graph from this function
# tape.gradient(loss, variables) traces all calculation occurred in with syntax.
# Computes the gradient using operations recorded in context of this tape.
# Returns ∂loss/∂variables.
@tf.function
def train_step(image):
    with tf.GradientTape() as tape:
        outputs = get_outputs(image)
        loss = style_weight * get_loss(outputs, style_outputs) + total_variation_weight * total_variation_loss(image)

    grad = tape.gradient(loss, image)
    opt.apply_gradients(grads_and_vars=[(grad, image)])
    image.assign(clip_0_1(image))


start = time.time()

image = tf.Variable(target_image)

epochs = 100
step_per_epoch = 100

step = 0
for n in range(epochs):
    for m in range(step_per_epoch):
        step += 1
        train_step(image)

    if n % 10 == 0:
        imageio.imwrite('../systhesis_result/epoch_{0}.png'.format(n), image.read_value().numpy())

imageio.imwrite('../systhesis_result/result.png', image.read_value().numpy())

display.clear_output(wait=True)
plt.imshow(image.read_value())
plt.show()

end = time.time()

print("Total time passed: {:.1f}".format(end - start))
